<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Jekyll::GtnFunctions - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/navigation.js" defer></script>
<script src="../js/search.js" defer></script>
<script src="../js/search_index.js" defer></script>
<script src="../js/searcher.js" defer></script>
<script src="../js/darkfish.js" defer></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    
<!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    <li ><a href="#method-c-cache">::cache</a>
    <li ><a href="#method-i-collapse_date_pretty">#collapse_date_pretty</a>
    <li ><a href="#method-i-convert_to_material_list">#convert_to_material_list</a>
    <li ><a href="#method-i-convert_workflow_path_to_trs">#convert_workflow_path_to_trs</a>
    <li ><a href="#method-i-elixirnode2name">#elixirnode2name</a>
    <li ><a href="#method-i-fedi2link">#fedi2link</a>
    <li ><a href="#method-i-fetch_contributor">#fetch_contributor</a>
    <li ><a href="#method-i-fetch_entity_avatar">#fetch_entity_avatar</a>
    <li ><a href="#method-i-fetch_entity_avatar_url">#fetch_entity_avatar_url</a>
    <li ><a href="#method-i-fetch_funding_url">#fetch_funding_url</a>
    <li ><a href="#method-i-filter_authors">#filter_authors</a>
    <li ><a href="#method-i-find_learningpaths_including_topic">#find_learningpaths_including_topic</a>
    <li ><a href="#method-i-fix_box_titles">#fix_box_titles</a>
    <li ><a href="#method-i-format_location">#format_location</a>
    <li ><a href="#method-i-format_location_short">#format_location_short</a>
    <li ><a href="#method-i-format_location_simple">#format_location_simple</a>
    <li ><a href="#method-i-get_default_link">#get_default_link</a>
    <li ><a href="#method-i-get_feedback_count">#get_feedback_count</a>
    <li ><a href="#method-i-get_feedback_count_recent">#get_feedback_count_recent</a>
    <li ><a href="#method-i-get_feedbacks">#get_feedbacks</a>
    <li ><a href="#method-i-get_og_desc">#get_og_desc</a>
    <li ><a href="#method-i-get_og_title">#get_og_title</a>
    <li ><a href="#method-i-get_rating">#get_rating</a>
    <li ><a href="#method-i-get_rating_histogram">#get_rating_histogram</a>
    <li ><a href="#method-i-get_rating_histogram_chart">#get_rating_histogram_chart</a>
    <li ><a href="#method-i-get_rating_recent">#get_rating_recent</a>
    <li ><a href="#method-i-get_recent_feedbacks">#get_recent_feedbacks</a>
    <li ><a href="#method-i-get_recent_feedbacks_time">#get_recent_feedbacks_time</a>
    <li ><a href="#method-i-get_topic">#get_topic</a>
    <li ><a href="#method-i-get_upcoming_events">#get_upcoming_events</a>
    <li ><a href="#method-i-get_upcoming_events_for_this">#get_upcoming_events_for_this</a>
    <li ><a href="#method-i-get_version_number">#get_version_number</a>
    <li ><a href="#method-i-get_videos_for_videos_page">#get_videos_for_videos_page</a>
    <li ><a href="#method-i-group_icons">#group_icons</a>
    <li ><a href="#method-i-gtn_mod_date">#gtn_mod_date</a>
    <li ><a href="#method-i-gtn_pub_date">#gtn_pub_date</a>
    <li ><a href="#method-i-how_many_topic_feedbacks">#how_many_topic_feedbacks</a>
    <li ><a href="#method-i-how_many_tutorial_feedbacks">#how_many_tutorial_feedbacks</a>
    <li ><a href="#method-i-humanize_types">#humanize_types</a>
    <li ><a href="#method-i-is_date_passed">#is_date_passed</a>
    <li ><a href="#method-i-last_modified_at">#last_modified_at</a>
    <li ><a href="#method-i-layout_to_human">#layout_to_human</a>
    <li ><a href="#method-i-list_usegalaxy_servers">#list_usegalaxy_servers</a>
    <li ><a href="#method-i-list_usegalaxy_servers_shuffle">#list_usegalaxy_servers_shuffle</a>
    <li ><a href="#method-i-load_svg">#load_svg</a>
    <li ><a href="#method-i-matches">#matches</a>
    <li ><a href="#method-i-materials_for_pathway">#materials_for_pathway</a>
    <li ><a href="#method-i-regex_replace">#regex_replace</a>
    <li ><a href="#method-i-regex_replace_once">#regex_replace_once</a>
    <li ><a href="#method-i-replace_newline_doublespace">#replace_newline_doublespace</a>
    <li ><a href="#method-i-shuffle">#shuffle</a>
    <li ><a href="#method-i-slugify_unsafe">#slugify_unsafe</a>
    <li ><a href="#method-i-to_stars">#to_stars</a>
    <li ><a href="#method-i-top_citations">#top_citations</a>
    <li ><a href="#method-i-topic_name_from_page">#topic_name_from_page</a>
    <li ><a href="#method-i-tutorials_over_time_bar_chart">#tutorials_over_time_bar_chart</a>
    <li ><a href="#method-i-unix_time_to_date">#unix_time_to_date</a>
    <li ><a href="#method-i-url_exists">#url_exists</a>
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Jekyll::GtnFunctions">
  <h1 id="module-Jekyll::GtnFunctions" class="module">
    module Jekyll::GtnFunctions
  </h1>

  <section class="description">
    
<p>This module contains functions that are used in the GTN, our internal functions that is.</p>

  </section>

  <section id="5Buntitled-5D" class="documentation-section">


    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
        <dt id="ELIXIR_NODES">ELIXIR_NODES
        <dd><p>List of elixir node country IDs (ISO 3166-1 alpha-2) and their names</p>
      </dl>
    </section>



     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

      <div id="method-c-cache" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">cache</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>rubocop:disable Naming/PredicateName</p>

          <div class="method-source-code" id="cache-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 39</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">cache</span>
  <span class="ruby-identifier">@@cache</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Jekyll</span><span class="ruby-operator">::</span><span class="ruby-constant">Cache</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;GtnFunctions&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

      <div id="method-i-collapse_date_pretty" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">collapse_date_pretty</span><span
              class="method-args">(event)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="collapse_date_pretty-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 666</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">collapse_date_pretty</span>(<span class="ruby-identifier">event</span>)
  <span class="ruby-identifier">collapse_event_date_pretty</span>(<span class="ruby-identifier">event</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-convert_to_material_list" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">convert_to_material_list</span><span
              class="method-args">(site, materials)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="convert_to_material_list-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 357</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_to_material_list</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">materials</span>)
  <span class="ruby-comment"># [{&quot;name&quot;=&gt;&quot;introduction&quot;, &quot;topic&quot;=&gt;&quot;admin&quot;}]</span>
  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">if</span> <span class="ruby-identifier">materials</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-identifier">materials</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;name&#39;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;topic&#39;</span>)
      <span class="ruby-identifier">found</span> = <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">TopicFilter</span>.<span class="ruby-identifier">fetch_tutorial_material</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;topic&#39;</span>], <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;name&#39;</span>])
      <span class="ruby-constant">Jekyll</span>.<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;Could not find material #{m[&#39;topic&#39;]}/#{m[&#39;name&#39;]} in the site data&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">found</span>.<span class="ruby-identifier">nil?</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;time&#39;</span>)
        <span class="ruby-identifier">found</span>[<span class="ruby-string">&#39;time&#39;</span>] = <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;time&#39;</span>]
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">found</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;external&#39;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;external&#39;</span>]
      {
        <span class="ruby-string">&#39;layout&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;tutorial_hands_on&#39;</span>,
        <span class="ruby-string">&#39;name&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;name&#39;</span>],
        <span class="ruby-string">&#39;title&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;name&#39;</span>],
        <span class="ruby-string">&#39;hands_on&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;external&#39;</span>,
        <span class="ruby-string">&#39;hands_on_url&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;link&#39;</span>],
      }
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;type&#39;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;type&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;custom&#39;</span>
      {
        <span class="ruby-string">&#39;layout&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;custom&#39;</span>,
        <span class="ruby-string">&#39;name&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;name&#39;</span>],
        <span class="ruby-string">&#39;title&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;name&#39;</span>],
        <span class="ruby-string">&#39;description&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;description&#39;</span>],
        <span class="ruby-string">&#39;time&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">m</span>[<span class="ruby-string">&#39;time&#39;</span>],
      }
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">Jekyll</span>.<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;[GTN] Unsure how to render #{m}&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-convert_workflow_path_to_trs" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">convert_workflow_path_to_trs</span><span
              class="method-args">(str)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Convert a workflow path to a TRS path Params:</p>
<dl class="rdoc-list note-list"><dt><code>str</code>
<dd>
<p>The workflow path</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The TRS path</p>
</dd></dl>

<p>Example:</p>

<pre>{{ &quot;topics/metagenomics/tutorials/mothur-miseq-sop-short/workflows/workflow1_quality_control.ga&quot; |
   convert_workflow_path_to_trs }}
=&gt; &quot;/api/ga4gh/trs/v2/tools/metagenomics-mothur-miseq-sop-short/versions/workflow1_quality_control&quot;</pre>

          <div class="method-source-code" id="convert_workflow_path_to_trs-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 403</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_workflow_path_to_trs</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;GTN_TRS_ERROR_NIL&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-identifier">m</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">%r{topics/(?&lt;topic&gt;.*)/tutorials/(?&lt;tutorial&gt;.*)/workflows/(?&lt;workflow&gt;.*)\.ga}</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-node">&quot;/api/ga4gh/trs/v2/tools/#{m[:topic]}-#{m[:tutorial]}/versions/#{m[:workflow].downcase}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">m</span>

  <span class="ruby-string">&#39;GTN_TRS_ERROR&#39;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-elixirnode2name" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">elixirnode2name</span><span
              class="method-args">(name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns the name of an elixir node, given its country ID Params:</p>
<dl class="rdoc-list note-list"><dt><code>name</code>
<dd>
<p>The country ID of the node (ISO 3166-1 alpha-2)</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The name of the node</p>
</dd></dl>

          <div class="method-source-code" id="elixirnode2name-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 76</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">elixirnode2name</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-constant">ELIXIR_NODES</span>[<span class="ruby-identifier">name</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-fedi2link" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">fedi2link</span><span
              class="method-args">(fedi_address)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Convert a fedi address to a link Params:</p>
<dl class="rdoc-list note-list"><dt><code>fedi_address</code>
<dd>
<p>The fedi address to convert</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The URL at which their profile is accessible</p>
</dd></dl>

<p>Example:</p>

<pre>{{ contributors[page.contributor].fediverse | fedi2link }}

fedi2link(&quot;@hexylena@galaxians.garden&quot;) =&gt; &quot;https://galaxians.garden/@hexylena&quot;</pre>

          <div class="method-source-code" id="fedi2link-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 317</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">fedi2link</span>(<span class="ruby-identifier">fedi_address</span>)
  <span class="ruby-identifier">fedi_address</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^@?(?&lt;user&gt;.*)@(?&lt;host&gt;.*)$/</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">_m</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;https://#{$LAST_MATCH_INFO[:host]}/@#{$LAST_MATCH_INFO[:user]}&quot;</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-fetch_contributor" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">fetch_contributor</span><span
              class="method-args">(site, id)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Params:</p>
<dl class="rdoc-list note-list"><dt><code>data</code>
<dd>
<p>The site data</p>
</dd><dt><code>string</code>
<dd>
<p>The contributor id</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>Hash</code>
<dd>
<p>The contributing entity</p>
</dd></dl>

<p>Example:</p>

<pre>{% assign contrib = site | fetch_contributor: page.contributor -%}</pre>

          <div class="method-source-code" id="fetch_contributor-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 250</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">fetch_contributor</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">id</span>)
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">Contributors</span>.<span class="ruby-identifier">fetch_contributor</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">id</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-fetch_entity_avatar" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">fetch_entity_avatar</span><span
              class="method-args">(entity, id, width)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Params:</p>
<dl class="rdoc-list note-list"><dt><code>data</code>
<dd>
<p>The contributor’s data</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The funding URL</p>
</dd></dl>

<p>Example:</p>

<pre>{{ entity | fetch_entity_avatar: &#39;alice&#39;, 120 }}</pre>

          <div class="method-source-code" id="fetch_entity_avatar-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 296</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">fetch_entity_avatar</span>(<span class="ruby-identifier">entity</span>, <span class="ruby-identifier">id</span>, <span class="ruby-identifier">width</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">entity</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;&lt;img src=&quot;/training-material/assets/images/avatar.png&quot; alt=&quot;ERROR_NO_ENTITY avatar&quot; class=&quot;avatar&quot;/&gt;&#39;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">w</span> = <span class="ruby-identifier">width</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;width=\&quot;#{width}\&quot;&quot;</span>
  <span class="ruby-identifier">url</span> = <span class="ruby-identifier">fetch_entity_avatar_url</span>(<span class="ruby-identifier">entity</span>, <span class="ruby-identifier">id</span>, <span class="ruby-identifier">width</span>)
  <span class="ruby-node">%(&lt;img src=&quot;#{url}&quot; alt=&quot;#{entity[&#39;name&#39;]} avatar&quot; #{w} class=&quot;avatar&quot; /&gt;)</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-fetch_entity_avatar_url" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">fetch_entity_avatar_url</span><span
              class="method-args">(entity, id, width)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Params:</p>
<dl class="rdoc-list note-list"><dt><code>data</code>
<dd>
<p>The contributor’s data</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The avatar’s URL</p>
</dd></dl>

<p>Example:</p>

<pre>{{ entity | fetch_entity_avatar: &#39;alice&#39;, 120 }}</pre>

          <div class="method-source-code" id="fetch_entity_avatar_url-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 274</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">fetch_entity_avatar_url</span>(<span class="ruby-identifier">entity</span>, <span class="ruby-identifier">id</span>, <span class="ruby-identifier">width</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;ERROR_NO_ENTITY&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">entity</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-identifier">width</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;width=\&quot;#{width}\&quot;&quot;</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">entity</span>[<span class="ruby-string">&#39;avatar&#39;</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">entity</span>[<span class="ruby-string">&#39;avatar&#39;</span>]
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">entity</span>[<span class="ruby-string">&#39;github&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">qp</span> = <span class="ruby-identifier">width</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;?s=#{width}&quot;</span>
    <span class="ruby-node">&quot;https://avatars.githubusercontent.com/#{id}#{qp}&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-string">&#39;/training-material/assets/images/avatar.png&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-fetch_funding_url" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">fetch_funding_url</span><span
              class="method-args">(entity)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Params:</p>
<dl class="rdoc-list note-list"><dt><code>data</code>
<dd>
<p>The contributor’s data</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The funding URL</p>
</dd></dl>

<p>Example:</p>

<pre>{{ entity | fetch_funding_url }}</pre>

          <div class="method-source-code" id="fetch_funding_url-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 262</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">fetch_funding_url</span>(<span class="ruby-identifier">entity</span>)
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">Contributors</span>.<span class="ruby-identifier">fetch_funding_url</span>(<span class="ruby-identifier">entity</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-filter_authors" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">filter_authors</span><span
              class="method-args">(data)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Params:</p>
<dl class="rdoc-list note-list"><dt><code>data</code>
<dd>
<p>The page data</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>Array</code>
<dd>
<p>The “authors” of the material (list of strings)</p>
</dd></dl>

<p>Example:</p>

<pre>{% assign authors = page | filter_authors -%}</pre>

          <div class="method-source-code" id="filter_authors-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 237</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">filter_authors</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">Contributors</span>.<span class="ruby-identifier">get_authors</span>(<span class="ruby-identifier">data</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-find_learningpaths_including_topic" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">find_learningpaths_including_topic</span><span
              class="method-args">(site, topic_id)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="find_learningpaths_including_topic-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 919</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">find_learningpaths_including_topic</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">topic_id</span>)
  <span class="ruby-identifier">site</span>.<span class="ruby-identifier">pages</span>
      .<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>[<span class="ruby-string">&#39;layout&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;learning-pathway&#39;</span> }
      .<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">materials_for_pathway</span>(<span class="ruby-identifier">p</span>)
      .<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">topic</span>, <span class="ruby-identifier">_tutorial</span><span class="ruby-operator">|</span> <span class="ruby-identifier">topic</span> }
      .<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">topic_id</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-fix_box_titles" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">fix_box_titles</span><span
              class="method-args">(content, lang, key)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Fix the titles of boxes in a page Params:</p>
<dl class="rdoc-list note-list"><dt><code>content</code>
<dd>
<p>The content to fix</p>
</dd><dt><code>lang</code>
<dd>
<p>The language of the content</p>
</dd><dt><code>key</code>
<dd>
<p>The key of the content</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The fixed content</p>
</dd></dl>

          <div class="method-source-code" id="fix_box_titles-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 225</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">fix_box_titles</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">lang</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">Boxify</span>.<span class="ruby-identifier">replace_elements</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">lang</span>, <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-format_location" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">format_location</span><span
              class="method-args">(location)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="format_location-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 595</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">format_location</span>(<span class="ruby-identifier">location</span>)
  <span class="ruby-identifier">url</span> = <span class="ruby-string">&#39;https://www.openstreetmap.org/search?query=&#39;</span>
  <span class="ruby-comment"># location:</span>
  <span class="ruby-comment">#   name: Bioinf Dept</span>
  <span class="ruby-comment">#   address: 42 E Main St.</span>
  <span class="ruby-comment">#   city: Reyjkjavik</span>
  <span class="ruby-comment">#   country: Iceland</span>
  <span class="ruby-comment">#   #region: # optional</span>
  <span class="ruby-comment">#   postcode: 912NM</span>
  <span class="ruby-identifier">loc</span> = [
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;name&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;address&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;city&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;region&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;country&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;postcode&#39;</span>, <span class="ruby-keyword">nil</span>)
  ].<span class="ruby-identifier">compact</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">loc</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
    <span class="ruby-node">&quot;&lt;a href=\&quot;#{url}#{loc.join(&#39;, &#39;)}\&quot;&gt;#{loc.join(&#39;, &#39;)}&lt;/a&gt;&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Just e.g. the name</span>
    <span class="ruby-identifier">loc</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;, &#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-format_location_short" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">format_location_short</span><span
              class="method-args">(location)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="format_location_short-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 634</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">format_location_short</span>(<span class="ruby-identifier">location</span>)
  <span class="ruby-identifier">url</span> = <span class="ruby-string">&#39;https://www.openstreetmap.org/search?query=&#39;</span>
  <span class="ruby-comment"># location:</span>
  <span class="ruby-comment">#   name: Bioinf Dept</span>
  <span class="ruby-comment">#   address: 42 E Main St.</span>
  <span class="ruby-comment">#   city: Reyjkjavik</span>
  <span class="ruby-comment">#   country: Iceland</span>
  <span class="ruby-comment">#   #region: # optional</span>
  <span class="ruby-comment">#   postcode: 912NM</span>
  <span class="ruby-identifier">loc</span> = [
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;name&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;address&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;city&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;region&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;country&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;postcode&#39;</span>, <span class="ruby-keyword">nil</span>)
  ].<span class="ruby-identifier">compact</span>

  <span class="ruby-identifier">loc2</span> = [
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;name&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;city&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;country&#39;</span>, <span class="ruby-keyword">nil</span>)
  ].<span class="ruby-identifier">compact</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">loc</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
    <span class="ruby-node">&quot;&lt;a href=\&quot;#{url}#{loc.join(&#39;, &#39;)}\&quot;&gt;#{loc2.join(&#39;, &#39;)}&lt;/a&gt;&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Just e.g. the name</span>
    <span class="ruby-identifier">loc</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;, &#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-format_location_simple" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">format_location_simple</span><span
              class="method-args">(location)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="format_location_simple-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 621</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">format_location_simple</span>(<span class="ruby-identifier">location</span>)
  <span class="ruby-identifier">loc</span> = [
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;name&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;address&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;city&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;region&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;country&#39;</span>, <span class="ruby-keyword">nil</span>),
    <span class="ruby-identifier">location</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;postcode&#39;</span>, <span class="ruby-keyword">nil</span>)
  ].<span class="ruby-identifier">compact</span>

  <span class="ruby-identifier">loc</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;, &#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_default_link" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_default_link</span><span
              class="method-args">(material)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Gets the ‘default’ link for a material, hands on if it exists, otherwise slides. Params:</p>
<dl class="rdoc-list note-list"><dt><code>material</code>
<dd>
<p>The material to get the link for</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The URL of the default link</p>
</dd></dl>

          <div class="method-source-code" id="get_default_link-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 886</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_default_link</span>(<span class="ruby-identifier">material</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;NO LINK&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">material</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;NO LINK&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">material</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">url</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">url</span> = <span class="ruby-node">&quot;topics/#{material[&#39;topic_name&#39;]}/tutorials/#{material[&#39;tutorial_name&#39;]}/slides.html&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;slides&#39;</span>]

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;hands_on&#39;</span>] <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;hands_on&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;external&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;hands_on&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;&#39;</span>)
    <span class="ruby-identifier">url</span> = <span class="ruby-node">&quot;topics/#{material[&#39;topic_name&#39;]}/tutorials/#{material[&#39;tutorial_name&#39;]}/tutorial.html&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">url</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_feedback_count" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_feedback_count</span><span
              class="method-args">(site, material_id)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_feedback_count-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 509</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_feedback_count</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
  <span class="ruby-identifier">get_feedbacks</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>).<span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_feedback_count_recent" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_feedback_count_recent</span><span
              class="method-args">(site, material_id)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_feedback_count_recent-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 513</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_feedback_count_recent</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
  <span class="ruby-identifier">get_recent_feedbacks_time</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>).<span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_feedbacks" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_feedbacks</span><span
              class="method-args">(site, material_id)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_feedbacks-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 477</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_feedbacks</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">if</span> <span class="ruby-identifier">material_id</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">topic</span>, <span class="ruby-identifier">tutorial</span> = <span class="ruby-identifier">material_id</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;/&#39;</span>)

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">tutorial</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&#39;:&#39;</span>)
      <span class="ruby-identifier">language</span> = <span class="ruby-identifier">tutorial</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;:&#39;</span>)[<span class="ruby-value">1</span>]
      <span class="ruby-identifier">tutorial</span> = <span class="ruby-identifier">tutorial</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;:&#39;</span>)[<span class="ruby-value">0</span>]
      <span class="ruby-comment"># If a language is supplied, then</span>
      <span class="ruby-identifier">feedbacks</span> = <span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;feedback2&#39;</span>][<span class="ruby-identifier">topic</span>][<span class="ruby-identifier">tutorial</span>]
                      .<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;lang&#39;</span>] <span class="ruby-operator">||</span> <span class="ruby-string">&#39;&#39;</span>).<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">language</span>.<span class="ruby-identifier">downcase</span> }
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># English is the default</span>
      <span class="ruby-identifier">feedbacks</span> = <span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;feedback2&#39;</span>][<span class="ruby-identifier">topic</span>][<span class="ruby-identifier">tutorial</span>]
                      .<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;lang&#39;</span>].<span class="ruby-identifier">nil?</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span>
    <span class="ruby-keyword">return</span> []
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">if</span> <span class="ruby-identifier">feedbacks</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">feedbacks</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-identifier">feedbacks</span>
    .<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;date&#39;</span>] }
    .<span class="ruby-identifier">reverse</span>
    .<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;stars&#39;</span>] = <span class="ruby-identifier">to_stars</span>(<span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;rating&#39;</span>])
    <span class="ruby-identifier">f</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_og_desc" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_og_desc</span><span
              class="method-args">(site, page)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_og_desc-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 825</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_og_desc</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">page</span>); <span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_og_title" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_og_title</span><span
              class="method-args">(site, page, reverse)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_og_title-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 827</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_og_title</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">page</span>, <span class="ruby-identifier">reverse</span>)
  <span class="ruby-identifier">og_title</span> = []
  <span class="ruby-identifier">topic_id</span> = <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;path&#39;</span>].<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">%r{^\./}</span>, <span class="ruby-string">&#39;&#39;</span>).<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;/&#39;</span>)[<span class="ruby-value">1</span>]

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">topic_id</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>[<span class="ruby-identifier">topic_id</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>[<span class="ruby-identifier">topic_id</span>].<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;title&#39;</span>)
      <span class="ruby-identifier">og_title</span> = [<span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>[<span class="ruby-identifier">topic_id</span>][<span class="ruby-string">&#39;title&#39;</span>].<span class="ruby-identifier">clone</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">Jekyll</span>.<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;Missing title for #{topic_id}&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;layout&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;topic&#39;</span>
    <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-string">&#39;Tutorial List&#39;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39; / &#39;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">material_id</span> = <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;path&#39;</span>].<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">%r{^\./}</span>, <span class="ruby-string">&#39;&#39;</span>).<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;/&#39;</span>)[<span class="ruby-value">3</span>]
  <span class="ruby-identifier">material</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">material</span> = <span class="ruby-identifier">fetch_tutorial_material</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">topic_id</span>, <span class="ruby-identifier">material_id</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>.<span class="ruby-identifier">key?</span> <span class="ruby-identifier">topic_id</span>

  <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;title&#39;</span>] <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">material</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;layout&#39;</span>]
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;workflow-list&#39;</span>
    <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-string">&#39;Workflows&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;faq-page&#39;</span>, <span class="ruby-string">&#39;faqs&#39;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;path&#39;</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r{faqs/gtn}</span>
      <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-string">&#39;GTN FAQs&#39;</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;path&#39;</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r{faqs/galaxy}</span>
      <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-string">&#39;Galaxy FAQs&#39;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-string">&#39;FAQs&#39;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;faq&#39;</span>
    <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-node">&quot;FAQ: #{page[&#39;title&#39;]}&quot;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;learning-pathway&#39;</span>
    <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-node">&quot;Learning Pathway: #{page[&#39;title&#39;]}&quot;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;tutorial_hands_on&#39;</span>
    <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-node">&quot;Hands-on: #{page[&#39;title&#39;]}&quot;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/slides/</span>
    <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-node">&quot;Slides: #{page[&#39;title&#39;]}&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;title&#39;</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;true&#39;</span>
    <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39; / &#39;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/Hands-on: Hands-on:/</span>, <span class="ruby-string">&#39;Hands-on:&#39;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">og_title</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39; / &#39;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/Hands-on: Hands-on:/</span>, <span class="ruby-string">&#39;Hands-on:&#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_rating" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_rating</span><span
              class="method-args">(site, material_id, recent: false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_rating-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 453</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_rating</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>, <span class="ruby-value">recent:</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">f</span> = <span class="ruby-identifier">get_rating_histogram</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>, <span class="ruby-value">recent:</span> <span class="ruby-identifier">recent</span>)
  <span class="ruby-identifier">rating</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">v</span> }.<span class="ruby-identifier">sum</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">_k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> }.<span class="ruby-identifier">sum</span>.<span class="ruby-identifier">to_f</span>
  <span class="ruby-identifier">rating</span>.<span class="ruby-identifier">round</span>(<span class="ruby-value">1</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_rating_histogram" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_rating_histogram</span><span
              class="method-args">(site, material_id, recent: false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_rating_histogram-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 431</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_rating_histogram</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>, <span class="ruby-value">recent:</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">return</span> {} <span class="ruby-keyword">if</span> <span class="ruby-identifier">material_id</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-identifier">feedbacks</span> = <span class="ruby-identifier">recent</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">get_recent_feedbacks_time</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">get_feedbacks</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)

  <span class="ruby-keyword">return</span> {} <span class="ruby-keyword">if</span> <span class="ruby-identifier">feedbacks</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">feedbacks</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-identifier">ratings</span> = <span class="ruby-identifier">feedbacks</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;rating&#39;</span>] }
  <span class="ruby-identifier">ratings</span>.<span class="ruby-identifier">each_with_object</span>(<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>)) { <span class="ruby-operator">|</span><span class="ruby-identifier">w</span>, <span class="ruby-identifier">counts</span><span class="ruby-operator">|</span> <span class="ruby-identifier">counts</span>[<span class="ruby-identifier">w</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_rating_histogram_chart" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_rating_histogram_chart</span><span
              class="method-args">(site, material_id)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_rating_histogram_chart-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 442</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_rating_histogram_chart</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
  <span class="ruby-identifier">histogram</span> = <span class="ruby-identifier">get_rating_histogram</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
  <span class="ruby-keyword">return</span> {} <span class="ruby-keyword">if</span> <span class="ruby-identifier">histogram</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-identifier">highest</span> = <span class="ruby-identifier">histogram</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">_k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> }.<span class="ruby-identifier">max</span>
  <span class="ruby-identifier">histogram</span>
    .<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">k</span>, [<span class="ruby-identifier">v</span>, <span class="ruby-identifier">v</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">highest</span>.<span class="ruby-identifier">to_f</span>]] }
    .<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">_v</span><span class="ruby-operator">|</span> <span class="ruby-operator">-</span><span class="ruby-identifier">k</span> }
    .<span class="ruby-identifier">to_h</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_rating_recent" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_rating_recent</span><span
              class="method-args">(site, material_id)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_rating_recent-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 459</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_rating_recent</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">get_rating</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>, <span class="ruby-value">recent:</span> <span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nan?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">get_rating</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>, <span class="ruby-value">recent:</span> <span class="ruby-keyword">false</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">r</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_recent_feedbacks" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_recent_feedbacks</span><span
              class="method-args">(site, material_id)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_recent_feedbacks-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 531</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_recent_feedbacks</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
  <span class="ruby-identifier">feedbacks</span> = <span class="ruby-identifier">get_feedbacks</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
              .<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;pro&#39;</span>]&amp;.<span class="ruby-identifier">length</span>&amp;.<span class="ruby-identifier">positive?</span> <span class="ruby-operator">||</span>
                  <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;con&#39;</span>]&amp;.<span class="ruby-identifier">length</span>&amp;.<span class="ruby-identifier">positive?</span>
              <span class="ruby-keyword">end</span>
              .<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;f_date&#39;</span>] = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;date&#39;</span>]).<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&#39;%B %Y&#39;</span>)
    <span class="ruby-identifier">f</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">last_year</span> = <span class="ruby-identifier">feedbacks</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;date&#39;</span>]) <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span> <span class="ruby-operator">-</span> <span class="ruby-value">365</span> }
  <span class="ruby-comment"># If we have fewer than 20 in the last year, then extend further.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">last_year</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">20</span>
    <span class="ruby-identifier">feedbacks</span>
      .<span class="ruby-identifier">first</span>(<span class="ruby-value">20</span>)
      .<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;f_date&#39;</span>] }
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Otherwise just everything last year.</span>
    <span class="ruby-identifier">last_year</span>
      .<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;f_date&#39;</span>] }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_recent_feedbacks_time" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_recent_feedbacks_time</span><span
              class="method-args">(site, material_id)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_recent_feedbacks_time-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 517</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_recent_feedbacks_time</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
  <span class="ruby-identifier">feedbacks</span> = <span class="ruby-identifier">get_feedbacks</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material_id</span>)
              .<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;pro&#39;</span>]&amp;.<span class="ruby-identifier">length</span>&amp;.<span class="ruby-identifier">positive?</span> <span class="ruby-operator">||</span>
                  <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;con&#39;</span>]&amp;.<span class="ruby-identifier">length</span>&amp;.<span class="ruby-identifier">positive?</span>
              <span class="ruby-keyword">end</span>
              .<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;f_date&#39;</span>] = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;date&#39;</span>]).<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&#39;%B %Y&#39;</span>)
    <span class="ruby-identifier">f</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">feedbacks</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">f</span>[<span class="ruby-string">&#39;date&#39;</span>]) <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span> <span class="ruby-operator">-</span> <span class="ruby-value">365</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_topic" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_topic</span><span
              class="method-args">(page)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Get the topic of a page’s path Params:</p>
<dl class="rdoc-list note-list"><dt><code>page</code>
<dd>
<p>The page to get the topic of, it will inspect <a href="&#39;path&#39;">page</a></p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The topic of the page</p>
</dd></dl>

<p>Example:</p>

<pre>{{ page | get_topic }}</pre>

          <div class="method-source-code" id="get_topic-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 679</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_topic</span>(<span class="ruby-identifier">page</span>)
  <span class="ruby-comment"># Arrays that will store all introduction slides and tutorials we discover.</span>
  <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;path&#39;</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;/&#39;</span>)[<span class="ruby-value">1</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_upcoming_events" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_upcoming_events</span><span
              class="method-args">(site)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Get the list of ‘upcoming’ events (i.e. reg deadline or start is 30 days away.) Params:</p>
<dl class="rdoc-list note-list"><dt><code>site</code>
<dd>
<p>The site object</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>Array</code>
<dd>
<p>List of events</p>
</dd></dl>

<p>Example:</p>

<pre>{{ site | get_upcoming_events }}</pre>

          <div class="method-source-code" id="get_upcoming_events-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 693</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_upcoming_events</span>(<span class="ruby-identifier">site</span>)
  <span class="ruby-identifier">cache</span>.<span class="ruby-identifier">getset</span>(<span class="ruby-string">&#39;upcoming-events&#39;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">site</span>.<span class="ruby-identifier">pages</span>
        .<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;layout&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;event&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;layout&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;event-external&#39;</span> }
        .<span class="ruby-identifier">reject</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;program&#39;</span>].<span class="ruby-identifier">nil?</span> } <span class="ruby-comment"># Only those with programs</span>
        .<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;event_upcoming&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span> } <span class="ruby-comment"># Only those coming soon</span>
        .<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">materials</span> = <span class="ruby-identifier">p</span>.<span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;program&#39;</span>]
                   .<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">section</span><span class="ruby-operator">|</span> <span class="ruby-identifier">section</span>[<span class="ruby-string">&#39;tutorials&#39;</span>] }
                   .<span class="ruby-identifier">flatten</span>
                   .<span class="ruby-identifier">compact</span> <span class="ruby-comment"># Remove nil entries</span>
                   .<span class="ruby-identifier">reject</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;type&#39;</span>, <span class="ruby-keyword">nil</span>) <span class="ruby-operator">==</span> <span class="ruby-string">&#39;custom&#39;</span> } <span class="ruby-comment"># Remove custom entries</span>
                   .<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{x[&#39;topic&#39;]}/#{x[&#39;name&#39;]}&quot;</span> } <span class="ruby-comment"># Just the material IDs.</span>
                   .<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">uniq</span>
      [<span class="ruby-identifier">p</span>, <span class="ruby-identifier">materials</span>]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_upcoming_events_for_this" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_upcoming_events_for_this</span><span
              class="method-args">(site, material)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Get the list of ‘upcoming’ events that include this material’s ID Params:</p>
<dl class="rdoc-list note-list"><dt><code>site</code>
<dd>
<p>The site object</p>
</dd><dt><code>material</code>
<dd>
<p>The ‘material’ to get the topic of, it will inspect page.id (use new_material)</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>Array</code>
<dd>
<p>List of events</p>
</dd></dl>

<p>Example:</p>

<pre>{{ site | get_upcoming_events }}</pre>

          <div class="method-source-code" id="get_upcoming_events_for_this-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 723</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_upcoming_events_for_this</span>(<span class="ruby-identifier">site</span>, <span class="ruby-identifier">material</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">material</span>.<span class="ruby-identifier">nil?</span>
    []
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">get_upcoming_events</span>(<span class="ruby-identifier">site</span>)
      .<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">_p</span>, <span class="ruby-identifier">materials</span><span class="ruby-operator">|</span> <span class="ruby-identifier">materials</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;id&#39;</span>] }
      .<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span>, <span class="ruby-identifier">_materials</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_version_number" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_version_number</span><span
              class="method-args">(page)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="get_version_number-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 427</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_version_number</span>(<span class="ruby-identifier">page</span>)
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">ModificationTimes</span>.<span class="ruby-identifier">obtain_modification_count</span>(<span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;path&#39;</span>])
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-get_videos_for_videos_page" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">get_videos_for_videos_page</span><span
              class="method-args">(site)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Get the list of all videos for the site (the automated + manual.) Params:</p>
<dl class="rdoc-list note-list"><dt><code>site</code>
<dd>
<p>The site object</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>Array</code>
<dd>
<p>List of [topic_id, topic_name, automated_videos, manual_videos]</p>
</dd></dl>

<p>Example:</p>

<pre>{{ site | get_videos_for_videos_page }}</pre>

          <div class="method-source-code" id="get_videos_for_videos_page-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 743</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_videos_for_videos_page</span>(<span class="ruby-identifier">site</span>)
  <span class="ruby-identifier">res</span> = {}
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">TopicFilter</span>.<span class="ruby-identifier">list_all_materials</span>(<span class="ruby-identifier">site</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">material</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;video&#39;</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;recordings&#39;</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;slides_recordings&#39;</span>]

    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">res</span>.<span class="ruby-identifier">key?</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;topic_name&#39;</span>]
      <span class="ruby-identifier">res</span>[<span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;topic_name&#39;</span>]] = {
        <span class="ruby-string">&#39;topic_id&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;topic_name&#39;</span>],
        <span class="ruby-string">&#39;topic_name&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>[<span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;topic_name&#39;</span>]][<span class="ruby-string">&#39;title&#39;</span>],
        <span class="ruby-string">&#39;automated_videos&#39;</span> <span class="ruby-operator">=&gt;</span> [],
        <span class="ruby-string">&#39;manual_videos&#39;</span> <span class="ruby-operator">=&gt;</span> []
      }
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Automated recording</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;video&#39;</span>]
      <span class="ruby-identifier">vid</span> = <span class="ruby-node">&quot;#{material[&#39;topic_name&#39;]}/tutorials/#{material[&#39;tutorial_name&#39;]}/slides&quot;</span>
      <span class="ruby-identifier">res</span>[<span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;topic_name&#39;</span>]][<span class="ruby-string">&#39;automated_videos&#39;</span>].<span class="ruby-identifier">push</span>({
        <span class="ruby-string">&#39;title&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;title&#39;</span>],
        <span class="ruby-string">&#39;vid&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">vid</span>,
        <span class="ruby-string">&#39;type&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;internal&#39;</span>,
        <span class="ruby-string">&#39;speakers&#39;</span> <span class="ruby-operator">=&gt;</span> [<span class="ruby-string">&#39;awspolly&#39;</span>],
        <span class="ruby-string">&#39;captioners&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">Contributors</span>.<span class="ruby-identifier">get_authors</span>(<span class="ruby-identifier">material</span>),
        <span class="ruby-string">&#39;cover&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-node">&quot;https://training.galaxyproject.org/videos/topics/#{vid}.mp4.png&quot;</span>
      })
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;slides_recordings&#39;</span>]
      <span class="ruby-identifier">rec</span> = <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;slides_recordings&#39;</span>].<span class="ruby-identifier">max_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>[<span class="ruby-string">&#39;date&#39;</span>] }
      <span class="ruby-identifier">res</span>[<span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;topic_name&#39;</span>]][<span class="ruby-string">&#39;manual_videos&#39;</span>].<span class="ruby-identifier">push</span>({
        <span class="ruby-string">&#39;title&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;title&#39;</span>],
        <span class="ruby-string">&#39;vid&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">rec</span>[<span class="ruby-string">&#39;youtube_id&#39;</span>],
        <span class="ruby-string">&#39;type&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;youtube&#39;</span>,
        <span class="ruby-string">&#39;speakers&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">rec</span>[<span class="ruby-string">&#39;speakers&#39;</span>],
        <span class="ruby-string">&#39;captioners&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">rec</span>[<span class="ruby-string">&#39;captioners&#39;</span>],
        <span class="ruby-string">&#39;cover&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-node">&quot;https://img.youtube.com/vi/#{rec[&#39;youtube_id&#39;]}/sddefault.jpg&quot;</span>
      })
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;recordings&#39;</span>]
      <span class="ruby-identifier">rec</span> = <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;recordings&#39;</span>].<span class="ruby-identifier">max_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>[<span class="ruby-string">&#39;date&#39;</span>] }
      <span class="ruby-identifier">res</span>[<span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;topic_name&#39;</span>]][<span class="ruby-string">&#39;manual_videos&#39;</span>].<span class="ruby-identifier">push</span>({
        <span class="ruby-string">&#39;title&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;title&#39;</span>],
        <span class="ruby-string">&#39;vid&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">rec</span>[<span class="ruby-string">&#39;youtube_id&#39;</span>],
        <span class="ruby-string">&#39;type&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;youtube&#39;</span>,
        <span class="ruby-string">&#39;speakers&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">rec</span>[<span class="ruby-string">&#39;speakers&#39;</span>],
        <span class="ruby-string">&#39;captioners&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">rec</span>[<span class="ruby-string">&#39;captioners&#39;</span>],
        <span class="ruby-string">&#39;cover&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-node">&quot;https://img.youtube.com/vi/#{rec[&#39;youtube_id&#39;]}/sddefault.jpg&quot;</span>
      })
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">res</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>[<span class="ruby-string">&#39;automated_videos&#39;</span>].<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">v</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&#39;automated_videos&#39;</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>[<span class="ruby-string">&#39;manual_videos&#39;</span>].<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">v</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&#39;manual_videos&#39;</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">res</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-group_icons" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">group_icons</span><span
              class="method-args">(icons)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="group_icons-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 901</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">group_icons</span>(<span class="ruby-identifier">icons</span>)
  <span class="ruby-identifier">icons</span>.<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">_k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> }.<span class="ruby-identifier">transform_values</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">z</span><span class="ruby-operator">|</span> <span class="ruby-identifier">z</span>[<span class="ruby-value">0</span>] } }.<span class="ruby-identifier">invert</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-gtn_mod_date" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">gtn_mod_date</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns the last modified date of a page Params:</p>
<dl class="rdoc-list note-list"><dt><code>page</code>
<dd>
<p>The page to get the last modified date of</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The last modified date of the page</p>
</dd></dl>

          <div class="method-source-code" id="gtn_mod_date-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 182</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">gtn_mod_date</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-comment"># Automatically strips any leading slashes.</span>
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">ModificationTimes</span>.<span class="ruby-identifier">obtain_time</span>(<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">%r{^/}</span>, <span class="ruby-string">&#39;&#39;</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-gtn_pub_date" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">gtn_pub_date</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns the publication date of a page, when it was merged into ‘main` Params:</p>
<dl class="rdoc-list note-list"><dt><code>page</code>
<dd>
<p>The page to get the publication date of</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The publication date of the page</p>
</dd></dl>

          <div class="method-source-code" id="gtn_pub_date-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 156</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">gtn_pub_date</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-comment"># if it&#39;s not a string then log a warning</span>
  <span class="ruby-identifier">path</span> = <span class="ruby-identifier">path</span>[<span class="ruby-string">&#39;path&#39;</span>] <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">path</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
  <span class="ruby-comment"># Automatically strips any leading slashes.</span>
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">PublicationTimes</span>.<span class="ruby-identifier">obtain_time</span>(<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">%r{^/}</span>, <span class="ruby-string">&#39;&#39;</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-how_many_topic_feedbacks" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">how_many_topic_feedbacks</span><span
              class="method-args">(feedback, name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>How many times has a topic been mentioned in feedback? Params:</p>
<dl class="rdoc-list note-list"><dt><code>feedback</code>
<dd>
<p>The feedback to search through</p>
</dd><dt><code>name</code>
<dd>
<p>The name of the topic to search for</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>Integer</code>
<dd>
<p>The number of times the topic has been mentioned</p>
</dd></dl>

          <div class="method-source-code" id="how_many_topic_feedbacks-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 194</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">how_many_topic_feedbacks</span>(<span class="ruby-identifier">feedback</span>, <span class="ruby-identifier">name</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">feedback</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">feedback</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>[<span class="ruby-string">&#39;topic&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">name</span> }.<span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-how_many_tutorial_feedbacks" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">how_many_tutorial_feedbacks</span><span
              class="method-args">(feedback, name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>How many times has a tutorial been mentioned in feedback? Params:</p>
<dl class="rdoc-list note-list"><dt><code>feedback</code>
<dd>
<p>The feedback to search through</p>
</dd><dt><code>name</code>
<dd>
<p>The name of the tutorial to search for</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>Integer</code>
<dd>
<p>The number of times the tutorial has been mentioned</p>
</dd></dl>

          <div class="method-source-code" id="how_many_tutorial_feedbacks-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 209</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">how_many_tutorial_feedbacks</span>(<span class="ruby-identifier">feedback</span>, <span class="ruby-identifier">name</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">feedback</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">feedback</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>[<span class="ruby-string">&#39;tutorial&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">name</span> }.<span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-humanize_types" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">humanize_types</span><span
              class="method-args">(type)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Return human text for ruby types Params:</p>
<dl class="rdoc-list note-list"><dt><code>type</code>
<dd>
<p>The type to humanize</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The humanized type</p>
</dd></dl>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">humanize_types</span>(<span class="ruby-string">&quot;seq&quot;</span>) <span class="ruby-comment"># =&gt; &quot;List of Items&quot;</span>
</pre>

          <div class="method-source-code" id="humanize_types-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">humanize_types</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-identifier">data</span> = {
    <span class="ruby-string">&#39;seq&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;List of Items&#39;</span>,
    <span class="ruby-string">&#39;str&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;Free Text&#39;</span>,
    <span class="ruby-string">&#39;map&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;A dictionary/map&#39;</span>,
    <span class="ruby-string">&#39;float&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;Decimal Number&#39;</span>,
    <span class="ruby-string">&#39;int&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;Integer Number&#39;</span>,
    <span class="ruby-string">&#39;bool&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;Boolean&#39;</span>
  }
  <span class="ruby-identifier">data</span>[<span class="ruby-identifier">type</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-is_date_passed" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">is_date_passed</span><span
              class="method-args">(date)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="is_date_passed-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 815</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">is_date_passed</span>(<span class="ruby-identifier">date</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">date</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
    <span class="ruby-constant">Date</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">date</span>) <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">date</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-last_modified_at" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">last_modified_at</span><span
              class="method-args">(page)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns the last modified date of a page Params:</p>
<dl class="rdoc-list note-list"><dt><code>page</code>
<dd>
<p>The page to get the last modified date of</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The last modified date of the page</p>
</dd></dl>

<p>TODO: These two could be unified tbh</p>

          <div class="method-source-code" id="last_modified_at-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 171</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">last_modified_at</span>(<span class="ruby-identifier">page</span>)
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">ModificationTimes</span>.<span class="ruby-identifier">obtain_time</span>(<span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;path&#39;</span>])
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-layout_to_human" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">layout_to_human</span><span
              class="method-args">(layout)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="layout_to_human-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 412</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">layout_to_human</span>(<span class="ruby-identifier">layout</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">layout</span>
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/_slides/</span> <span class="ruby-comment"># excludes slides-plain</span>
    <span class="ruby-string">&#39;Slides&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/tutorial_hands_on/</span>
    <span class="ruby-string">&#39;Hands-on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;faq&#39;</span>
    <span class="ruby-string">&#39;FAQs&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;news&#39;</span>
    <span class="ruby-string">&#39;News&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;workflow&#39;</span>
    <span class="ruby-string">&#39;Workflow&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-list_usegalaxy_servers" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">list_usegalaxy_servers</span><span
              class="method-args">(_site)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="list_usegalaxy_servers-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 575</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">list_usegalaxy_servers</span>(<span class="ruby-identifier">_site</span>)
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">Usegalaxy</span>.<span class="ruby-identifier">servers</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">transform_keys</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_s</span>) }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-list_usegalaxy_servers_shuffle" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">list_usegalaxy_servers_shuffle</span><span
              class="method-args">(_site)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="list_usegalaxy_servers_shuffle-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 579</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">list_usegalaxy_servers_shuffle</span>(<span class="ruby-identifier">_site</span>)
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">Usegalaxy</span>.<span class="ruby-identifier">servers</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">transform_keys</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_s</span>) }.<span class="ruby-identifier">shuffle</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-load_svg" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">load_svg</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Load an SVG file directly into the page Params:</p>
<dl class="rdoc-list note-list"><dt><code>path</code>
<dd>
<p>The path of the SVG file (relative to GTN workspace root)</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The SVG file contents</p>
</dd></dl>

<p>Example:</p>

<pre>{{ &quot;assets/images/mastodon.svg&quot; | load_svg }}</pre>

          <div class="method-source-code" id="load_svg-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 330</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_svg</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\R+/</span>, <span class="ruby-string">&#39;&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-matches" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">matches</span><span
              class="method-args">(str, regex_search)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Check if a match is found</p>

          <div class="method-source-code" id="matches-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 352</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">matches</span>(<span class="ruby-identifier">str</span>, <span class="ruby-identifier">regex_search</span>)
  <span class="ruby-identifier">r</span> = <span class="ruby-regexp">/#{regex_search}/</span>
  <span class="ruby-identifier">str</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-identifier">r</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-materials_for_pathway" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">materials_for_pathway</span><span
              class="method-args">(page)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="materials_for_pathway-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 905</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">materials_for_pathway</span>(<span class="ruby-identifier">page</span>)
  <span class="ruby-identifier">d</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">page</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Jekyll</span><span class="ruby-operator">::</span><span class="ruby-constant">Page</span>)
        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">data</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;pathway&#39;</span>, [])
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;pathway&#39;</span>, [])
      <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">d</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">m</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;tutorials&#39;</span>, [])
     .<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;name&#39;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;topic&#39;</span>) }
     .<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;topic&#39;</span>], <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;name&#39;</span>]] }
  <span class="ruby-keyword">end</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">uniq</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-regex_replace" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">regex_replace</span><span
              class="method-args">(str, regex_search, value_replace)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="regex_replace-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 334</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">regex_replace</span>(<span class="ruby-identifier">str</span>, <span class="ruby-identifier">regex_search</span>, <span class="ruby-identifier">value_replace</span>)
  <span class="ruby-identifier">regex</span> = <span class="ruby-regexp">/#{regex_search}/m</span>
  <span class="ruby-identifier">str</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-identifier">regex</span>, <span class="ruby-identifier">value_replace</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-regex_replace_once" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">regex_replace_once</span><span
              class="method-args">(str, regex_search, value_replace)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>This method does a single regex replacement</p>

<h1 id="method-i-regex_replace_once-label-Example">Example<span><a href="#method-i-regex_replace_once-label-Example">&para;</a> <a href="#top">&uarr;</a></span></h1>

<pre>{{ content | regex_replace: &#39;&lt;hr&gt;&#39;, &#39;&#39; }}</pre>

          <div class="method-source-code" id="regex_replace_once-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 345</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">regex_replace_once</span>(<span class="ruby-identifier">str</span>, <span class="ruby-identifier">regex_search</span>, <span class="ruby-identifier">value_replace</span>)
  <span class="ruby-identifier">regex</span> = <span class="ruby-regexp">/#{regex_search}/m</span>
  <span class="ruby-identifier">str</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">regex</span>, <span class="ruby-identifier">value_replace</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-replace_newline_doublespace" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">replace_newline_doublespace</span><span
              class="method-args">(text)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Replaces newlines with newline + two spaces</p>

          <div class="method-source-code" id="replace_newline_doublespace-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 145</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">replace_newline_doublespace</span>(<span class="ruby-identifier">text</span>)
  <span class="ruby-identifier">text</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\n/</span>, <span class="ruby-string">&quot;\n  &quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-shuffle" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">shuffle</span><span
              class="method-args">(array)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="shuffle-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 807</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">shuffle</span>(<span class="ruby-identifier">array</span>)
  <span class="ruby-identifier">array</span>.<span class="ruby-identifier">shuffle</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-slugify_unsafe" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">slugify_unsafe</span><span
              class="method-args">(text)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>A slightly more unsafe slugify function Params:</p>
<dl class="rdoc-list note-list"><dt><code>text</code>
<dd>
<p>The text to slugify</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>String</code>
<dd>
<p>The slugified text</p>
</dd></dl>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">slugify_unsafe</span>(<span class="ruby-string">&quot;Hello, World!&quot;</span>) <span class="ruby-comment"># =&gt; &quot;Hello-World&quot;</span>
</pre>

          <div class="method-source-code" id="slugify_unsafe-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 117</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">slugify_unsafe</span>(<span class="ruby-identifier">text</span>)
  <span class="ruby-comment"># Gets rid of *most* things without making it completely unusable?</span>
  <span class="ruby-identifier">unsafe_slugify</span>(<span class="ruby-identifier">text</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-to_stars" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">to_stars</span><span
              class="method-args">(rating)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Only accepts an integer rating</p>

          <div class="method-source-code" id="to_stars-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 465</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">to_stars</span>(<span class="ruby-identifier">rating</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">rating</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">rating</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">rating</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;0&#39;</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">rating</span>.<span class="ruby-identifier">zero?</span>
    <span class="ruby-string">%(&lt;span class=&quot;sr-only&quot;&gt;0 stars&lt;/span&gt;)</span> <span class="ruby-operator">+</span>
      <span class="ruby-string">&#39;&lt;i class=&quot;far fa-star&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&#39;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">rating</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>
    <span class="ruby-string">&#39;&lt;span class=&quot;sr-only&quot;&gt;0 stars&lt;/span&gt;&lt;i class=&quot;far fa-star&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&#39;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-node">%(&lt;span class=&quot;sr-only&quot;&gt;#{rating} stars&lt;/span&gt;)</span> <span class="ruby-operator">+</span>
      (<span class="ruby-string">&#39;&lt;i class=&quot;fa fa-star&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&#39;</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">rating</span>.<span class="ruby-identifier">to_i</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-top_citations" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">top_citations</span><span
              class="method-args">(citations)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Obtain the most cited paper in the GTN Params:</p>
<dl class="rdoc-list note-list"><dt><code>citations</code>
<dd>
<p>The citations to search through</p>
</dd></dl>

<p>Returns:</p>
<dl class="rdoc-list note-list"><dt><code>Hash</code>
<dd>
<p>The papers including their text citation and citation count</p>
</dd></dl>

          <div class="method-source-code" id="top_citations-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">top_citations</span>(<span class="ruby-identifier">citations</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">citations</span>.<span class="ruby-identifier">nil?</span>
    {}
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">citations</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">_k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> }.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">to_h</span>.<span class="ruby-identifier">first</span>(<span class="ruby-value">20</span>).<span class="ruby-identifier">to_h</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
      [<span class="ruby-identifier">k</span>, { <span class="ruby-string">&#39;count&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">v</span>, <span class="ruby-string">&#39;text&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">Scholar</span>.<span class="ruby-identifier">render_citation</span>(<span class="ruby-identifier">k</span>) }]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-topic_name_from_page" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">topic_name_from_page</span><span
              class="method-args">(page, site)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="topic_name_from_page-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 583</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">topic_name_from_page</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">site</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">page</span>.<span class="ruby-identifier">key?</span> <span class="ruby-string">&#39;topic_name&#39;</span>
    <span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>[<span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;topic_name&#39;</span>]][<span class="ruby-string">&#39;title&#39;</span>]
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;url&#39;</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^\/faqs\/gtn/</span>
    <span class="ruby-string">&#39;GTN FAQ&#39;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;url&#39;</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^\/faqs\/galaxy/</span>
    <span class="ruby-string">&#39;Galaxy FAQ&#39;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">site</span>.<span class="ruby-identifier">data</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">page</span>[<span class="ruby-string">&#39;url&#39;</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;/&#39;</span>)[<span class="ruby-value">2</span>], { <span class="ruby-string">&#39;title&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;&#39;</span> })[<span class="ruby-string">&#39;title&#39;</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-tutorials_over_time_bar_chart" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">tutorials_over_time_bar_chart</span><span
              class="method-args">(site)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="tutorials_over_time_bar_chart-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 555</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">tutorials_over_time_bar_chart</span>(<span class="ruby-identifier">site</span>)
  <span class="ruby-identifier">graph</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>)
  <span class="ruby-constant">Gtn</span><span class="ruby-operator">::</span><span class="ruby-constant">TopicFilter</span>.<span class="ruby-identifier">list_all_materials</span>(<span class="ruby-identifier">site</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">material</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;pub_date&#39;</span>]
      <span class="ruby-identifier">yymm</span> = <span class="ruby-identifier">material</span>[<span class="ruby-string">&#39;pub_date&#39;</span>].<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&#39;%Y-%m&#39;</span>)
      <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">yymm</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Cumulative over time</span>
  <span class="ruby-comment"># https://stackoverflow.com/questions/71745593/how-to-do-a-single-line-cumulative-count-for-hash-values-in-ruby</span>
  <span class="ruby-identifier">graph</span>
    <span class="ruby-comment"># Turns it into an array</span>
    .<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">_v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span> }
    <span class="ruby-comment"># Cumulative sum</span>
    .<span class="ruby-identifier">each_with_object</span>([]) { <span class="ruby-operator">|</span>(<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span>), <span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">last</span>&amp;.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">to_i</span>] }.<span class="ruby-identifier">to_h</span>
    .<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> { <span class="ruby-string">&#39;x&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">k</span>, <span class="ruby-string">&#39;y&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">v</span> } }
    .<span class="ruby-identifier">to_json</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-unix_time_to_date" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">unix_time_to_date</span><span
              class="method-args">(time)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="unix_time_to_date-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 811</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unix_time_to_date</span>(<span class="ruby-identifier">time</span>)
  <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-identifier">time</span>.<span class="ruby-identifier">to_i</span>).<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&#39;%Y-%m-%d %H:%M:%S&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-url_exists" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">url_exists</span><span
              class="method-args">(url)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          

          <div class="method-source-code" id="url_exists-source">
            <pre><span class="ruby-comment"># File _plugins/gtn.rb, line 80</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">url_exists</span>(<span class="ruby-identifier">url</span>)
  <span class="ruby-identifier">cache</span>.<span class="ruby-identifier">getset</span>(<span class="ruby-node">&quot;url-exists-#{url}&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">url</span>)
    <span class="ruby-identifier">http</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>)
    <span class="ruby-identifier">http</span>.<span class="ruby-identifier">use_ssl</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;https&#39;</span>
    <span class="ruby-identifier">response</span> = <span class="ruby-identifier">http</span>.<span class="ruby-identifier">request_head</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)
    <span class="ruby-comment">#Jekyll.logger.warn response</span>
    <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;200&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.5.1.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

